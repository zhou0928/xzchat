# Security Policy

## 🔒 安全承诺

xzChat 项目团队致力于保护用户和项目代码的安全。我们认真对待所有的安全报告，并会尽力快速响应。

## 📋 支持的版本

我们只支持最新版本的 xzChat。如果你发现的安全问题影响到旧版本，请确保升级到最新版本后再报告。

## 🚨 报告安全漏洞

如果你发现安全漏洞，**请不要公开 Issue**，而是按照以下步骤私下报告：

### 报告流程

1. **发送邮件**至：security@xzchat.dev（或通过 GitHub 私信）
2. **在邮件中包含**：
   - 漏洞的详细描述
   - 复现步骤
   - 受影响的版本
   - 潜在的影响
   - 如果可能，提供修复建议

### 你可以期待的

- **确认**：我们会在 48 小时内确认收到报告
- **评估**：我们会在 7 天内评估漏洞的严重程度
- **修复**：我们会尽快修复漏洞，严重漏洞会优先处理
- **公布**：修复后我们会公布漏洞细节，并感谢你的贡献

### 奖励

对于重大的安全漏洞发现，我们可能会提供：
- 在安全公告中特别致谢
- xzChat 周边（如适用）
- 开源贡献者奖（如适用）

## 🔐 安全最佳实践

### 对于用户

1. **保护 API Key**
   - 不要将 API Key 提交到版本控制
   - 使用环境变量存储敏感信息
   - 定期轮换 API Key

2. **使用最新版本**
   ```bash
   npm update -g xzchat
   ```

3. **审查插件**
   - 只从可信来源安装插件
   - 审查插件的代码
   - 使用插件的验证功能检查插件质量

4. **日志安全**
   - 日志文件可能包含敏感信息
   - 定期清理日志：`~/.newapi-chat-logs/`
   - 不要分享包含敏感信息的日志

### 对于开发者

1. **依赖管理**
   - 定期更新依赖：`npm audit fix`
   - 检查漏洞：`npm audit`
   - 只使用必要的依赖

2. **代码审查**
   - 所有代码合并前需要审查
   - 特别注意安全相关的代码
   - 使用静态分析工具

3. **敏感数据处理**
   - 不要在日志中记录敏感信息
   - 使用安全的字符串处理
   - 验证所有用户输入

4. **插件安全**
   - 插件需要经过验证
   - 限制插件的权限
   - 使用沙箱执行环境（如适用）

## 🛡️ 已实施的安全措施

### 输入验证
- ✅ 路径遍历防护
- ✅ 命令注入防护
- ✅ 文件访问权限检查
- ✅ 危险命令检测

### 敏感信息保护
- ✅ API Key 自动过滤
- ✅ 日志中敏感信息清理
- ✅ 环境变量安全处理
- ✅ 配置文件加密（可选）

### 插件系统安全
- ✅ 插件验证（6 大验证模块）
- ✅ 依赖循环检测
- ✅ 插件隔离
- ✅ 插件权限控制

### 网络安全
- ✅ HTTPS 强制使用
- ✅ 证书验证
- ✅ 请求超时
- ✅ 重试机制

### 审计日志
- ✅ 操作记录（27 种操作类型）
- ✅ 敏感信息清理
- ✅ 日志查询和分析
- ✅ 异常检测

## 📊 安全事件等级

### 🔴 严重（Critical）
- 可以远程执行代码
- 可以获取用户敏感数据（API Key、密码等）
- 可以完全控制用户系统

**响应时间**：24 小时内修复

### 🟠 高危（High）
- 可以获取部分用户数据
- 可以影响系统可用性
- 需要用户交互才能利用

**响应时间**：3 天内修复

### 🟡 中危（Medium）
- 影响系统部分功能
- 需要特定条件才能利用
- 影响范围有限

**响应时间**：7 天内修复

### 🟢 低危（Low）
- 影响极小
- 利用困难
- 信息泄露风险低

**响应时间**：下一个版本修复

## 🔍 漏洞披露政策

### 披露时间线

1. **报告接收**：确认收到报告
2. **评估和修复**：开发和测试修复
3. **发布准备**：准备安全公告
4. **协调发布**：与报告者协调发布时间
5. **公开披露**：发布修复版本和安全公告

### 保留信息

我们不会公开以下信息，直到修复版本发布：
- 报告者的个人信息
- 漏洞的详细信息
- 攻击者可能利用的细节

### 致谢

我们会在安全公告中感谢发现者（如果你愿意）。

## 📚 安全资源

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [Node.js Security Best Practices](https://nodejs.org/en/docs/guides/security/)
- [npm Security](https://docs.npmjs.com/cli/v6/auditing-package-vulnerabilities)
- [Dependabot](https://github.com/features/security)

## 📞 联系方式

- **安全报告**：security@xzchat.dev
- **GitHub Security**：使用 GitHub 的 [Private Vulnerability Reporting](https://github.com/zhou0928/xzchat/security/advisories)
- **一般问题**：[GitHub Issues](https://github.com/zhou0928/xzchat/issues)

## 🔄 版本历史

| 版本 | 日期 | 安全更新 |
|------|------|---------|
| 2.4.0 | 2026-01-30 | 添加敏感信息过滤、路径验证、命令检查 |
| 2.3.5 | 2026-01-29 | 初始安全措施 |

## 📝 许可证

本项目的安全策略遵循 [MIT License](LICENSE)。

---

**感谢你帮助 xzChat 变得更安全！**
